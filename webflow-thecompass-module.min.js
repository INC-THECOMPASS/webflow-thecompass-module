let tc={};const Ref=e=>{let t=e,r=[],l=(e,t)=>r.push({subscriber:e,bind:t}),c=e=>(r=r.filter(t=>t.subscriber!==e)).length,i=e=>{t="function"==typeof e?e(t):e,r&&r.forEach(e=>e.subscriber(t,e.bind))};return Object.freeze({get:()=>t,set(e){i(e)},set value(val){i(val)},get value(){return t},update:i,subscribe:l,unsubscribe:c})};function dfs(dom){if(Array.from(dom.children).length>0)Array.from(dom.children).forEach(e=>{dfs(e)});else if(dom.innerText){let templates=dom.innerText.match(/\{\{ [\w\W]+ \}\}/g);templates&&templates.forEach(template=>{let key=template.replaceAll("{","").replaceAll("}","").replaceAll(" ","");void 0===tc[key]&&(tc[key]=Ref(0));let realKey=Object.keys(Object.assign(tc)).find(e=>-1!==key.indexOf(e));console.log(realKey),realKey&&"window"!=realKey&&(tc[realKey].subscribe((value,args)=>{let retValue=eval(key.replaceAll(realKey,realKey+".value "));-1===dom.innerText.indexOf(template)?dom.innerText=args.innerText.replaceAll(template,retValue):dom.innerText=dom.innerText.replaceAll(template,retValue)},{innerText:dom.innerText}),dom.style.visibility="visible")})}dom.getAttributeNames&&dom.getAttributeNames().forEach(name=>{let templates=dom.getAttribute(name).match(/\{\{ [\w]+ \}\}/g);templates&&templates.forEach(template=>{let key=template.replaceAll("{","").replaceAll("}","").replaceAll(" ","");void 0===tc[key]&&(tc[key]=Ref(0));let realKey=Object.keys(Object.assign(tc)).find(e=>-1!==key.indexOf(e));realKey&&"window"!=realKey&&tc[realKey].subscribe((value,args)=>{let retValue=eval(key.replaceAll(realKey,realKey+".value"));-1===dom.getAttribute(name).indexOf(template)?dom.setAttribute(name,args.prop.replaceAll(template,retValue)):dom.setAttribute(name,dom.getAttribute(name).replaceAll(template,retValue))},{prop:dom.getAttribute(name)})})})}window.addEventListener("load",()=>{initTC(),dfs(document),Object.keys(tc).forEach(e=>{window[e]=tc[e]}),initValue(),document.querySelectorAll("[aria-tc-onchange]").forEach(dom=>{dom.addEventListener("change",eval(dom.getAttribute("aria-tc-onchange")))}),document.querySelectorAll("[aria-tc-onclick]").forEach(dom=>{dom.addEventListener("click",eval(dom.getAttribute("aria-tc-onclick")))}),document.querySelectorAll("[aria-tc-onkeyup]").forEach(dom=>{dom.addEventListener("keyup",eval(dom.getAttribute("aria-tc-onkeyup")))})}),window.addEventListener("unload",()=>{Object.values(tc).forEach(e=>e.clear())});